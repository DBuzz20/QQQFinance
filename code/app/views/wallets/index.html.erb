<head></head>
<body >
<%=render "/header"%>

<div class="container">
<br>
 <div class="row">
   <div class="col-12">
     <h1>Valore totale wallet:</h1>
     <div class="text-center"><h2 style="color:green" id="valore"> <%=@tot%> $</h2></div>
   </div>
 </div>
 <hr>

 <form action="/wallet/movimenti" method='post' onsubmit="location.reload();">

 <div class="row">
  <div class="col-4">
   <h2>aggiungi posizione:</h2>
  </div>
  <div class="col-4">
  <input list="brow" class="form-control me-2" type="search" name="isin" id="isin"placeholder="Ricerca ISIN" aria-label="Cerca" required>
  <datalist id="brow">
   <%@az.each do |i|%>
    <option value=<%=i.isin%>>
   <%end%>
  </datalist>
  </div>
  <div class="col-2">
   <input name='quantita' id='quantita' type='number' min='1' placeholder="Quantità" class='form-control' required>
  </div>
  <div class="col-2">
   <button type="submit" class="btn btn-primary">Aggiungi</button>
 </div> 
 </form>
 </div>

 <hr>
 <div class="row">
   <h1>Azioni detenute:</h1>
   <div class=" table-responsive">
     <table name="portafoglio" style="text-align:center" class="table text-black" rules="rows">
       <tr>
       <th>Nome</th>
       <th>ISIN</th>
       <th>Paese</th>
       <th>Settore</th>
       <th>Quantità</th>
       <th>ValorePosizione</th>
       <tr></tr>
       </tr>
       <% i=0%>
       <%= while i<@azioni.length() do %>
       <tr><td><%=@azioni[i].nome%></td><td><%=@azioni[i].isin%></td><td><%=@azioni[i].paese%></td><td><%=@azioni[i].settore%></td><td><%=@quantita[i]%></td><td><%=@azioni[i].prezzo * @quantita[i]%>$</td><td><%= button_to 'rimuovi', wallets_path(params: { isin: @azioni[i].isin}), method: :delete, class: "btn btn-primary btn-danger btn-sm", data: { confirm: 'Sei sicuro di voler rimuovere questa posizione?' } %></td></tr>
       <% i+=1 %>
       <%end %>
     </table>
    </div>
    <% if @tot==0%>
    <p class="text-center">Il tuo wallet è vuoto.<br>Aggiungine alcune utilizzando l'apposito tool che trovi qui sopra o nella pagina <a href=../screener>screener</a></p>
    <%end%>
  </div>
  <%= button_to 'Cancella wallet', rimozione_wallet_path, method: :delete, class: "btn btn-primary btn-danger btn-sm", data: { confirm: 'Sei sicuro di voler eliminare l&#39 intero wallet? Tutte le modifiche andranno perse.'} %>
</div>
<%=render '/footer'%>
</body>